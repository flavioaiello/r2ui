"use strict";angular.module("r2ui",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ngMaterial","ui.router","base64","angularMoment"]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$urlMatcherFactoryProvider","$mdThemingProvider","dockerRegistryProvider",function(a,b,c,d,e,f){a.html5Mode(!0),d.type("repository",{encode:function(a){return null!==a?a.toString():a},decode:function(a){return null!==a?a.toString():a},is:function(a){return/.*/.test(a)}}),b.state("main",{url:"/",views:{menu:{templateUrl:"views/repositories.html",controller:"RepositoriesCtrl",controllerAs:"vm"}}}).state("main.repository",{url:"repositories/{name:repository}",views:{"content@":{templateUrl:"views/repository.html",controller:"RepositoryCtrl",controllerAs:"vm"}}}),c.otherwise("/"),e.theme("default").primaryPalette("indigo").accentPalette("orange"),f.setUsername(""),f.setPassword(""),f.setRegistryUrl(window.location.origin)}]),angular.module("r2ui").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("r2ui").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("r2ui").controller("RepositoriesCtrl",["$state","$mdToast","dockerRegistry",function(a,b,c){var d=this;d.openRepository=function(b){a.go("main.repository",{name:b})},c.getRepositories().then(function(a){d.repositories=a})["catch"](function(a){b.show(b.simple().content("Failed getting repositories: "+a.statusText).position("top right").hideDelay(3e3))})}]),angular.module("r2ui").provider("dockerRegistry",function(){var a=null,b=null,c=null;this.setUsername=function(b){a=b},this.setPassword=function(a){b=a},this.setRegistryUrl=function(a){c=a},this.$get=["$http","$base64","$document",function(d,e,f){function g(){if(!c)throw new Error("dockerRegistry requires setRegistryUrl to be called");this.getRepositories=function(){return d.get(c+"/v2/_catalog",{headers:h()}).then(function(a){return a.data.repositories})},this.getTags=function(a){return d.get(c+"/v2/"+a+"/tags/list",{headers:h()}).then(function(a){return a.data.tags})},this.getManifest=function(a,b){return d.get(c+"/v2/"+a+"/manifests/"+b,{headers:h()}).then(function(a){return a.data.history=a.data.history.map(function(a){return JSON.parse(a.v1Compatibility)}),a.data})},this.getRegistryBase=function(){var a=f[0].createElement("a");return a.href=c,a.hostname}}var h=function(){return{Authorization:"Basic "+e.encode([a,b].join(":"))}};return new g}]}),angular.module("r2ui").controller("RepositoryCtrl",["$stateParams","$q","dockerRegistry",function(a,b,c){var d=this;d.name=a.name,d.registryBase=c.getRegistryBase(),c.getTags(a.name).then(function(e){return d.tags=e.map(function(a){return{name:a}}),b.all(e.map(function(b){return c.getManifest(a.name,b)}))}).then(function(a){d.tags.forEach(function(b,c){b.manifest=a[c]})})}]),angular.module("r2ui").constant("CONFIG",{util:{}}),angular.module("r2ui").run(["$templateCache",function(a){a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>'),a.put("views/repositories.html",'<md-toolbar layout="row"> <div class="md-toolbar-tools"> <h1>Docker Registry v2 UI</h1> </div> </md-toolbar> <md-subheader class="md-primary">Catalog</md-subheader> <md-list> <div layout="row" layout-align="center center" ng-if="!vm.repositories"> <md-progress-circular md-mode="indeterminate"></md-progress-circular> </div> <md-list-item ng-click="vm.openRepository(repository)" ng-repeat="repository in vm.repositories" aria-label="{{ repository }}"> <p ng-bind="repository"></p> </md-list-item> </md-list>'),a.put("views/repository.html",'<div layout="column" layout-fill> <md-toolbar> <div class="md-toolbar-tools"> <h2>Repository: {{ vm.name }}</h2> </div> </md-toolbar> <md-content layout-padding> <md-card> <md-card-content> <h2>Info</h2> <p>To pull this repository, run:</p> <code>docker pull {{ vm.registryBase }}/{{ vm.name }}</code> </md-card-content> </md-card> <md-card> <md-card-content> <h2>Tags</h2> <div layout="row" layout-align="center center" ng-if="!vm.tags"> <md-progress-circular md-mode="indeterminate"></md-progress-circular> </div> <md-list> <md-list-item class="md-2-line" ng-repeat="tag in vm.tags"> <div class="md-list-item-text"> <h3 ng-bind="tag.name"></h3> <p ng-if="tag.manifest"> {{ tag.manifest.history[0].id | limitTo:8 }} ({{ tag.manifest.history[0].created | amDateFormat:\'MMMM Do YYYY, h:mm:ss a\' }}) </p> </div> </md-list-item> </md-list> </md-card-content> </md-card> </md-content> </div>')}]);